application {
  name = "first input test "
  hive.enabled = false
}

global {
  datasource {
    dwh {
      url = "jdbc:postgresql://192.168.1.91:5433/hbi_dw_shhs"
      username = "hbi_dw"
      password = "thoth123"
    }
  }
}

steps {
  dim_bi_dept {
    input {
      type = postgresql-input
      datasource = ${global.datasource.dwh}
      query = "(select * from dwd.dwd_his_ip_charges_p201808)"
      fetch-size = 100
      mode = bulk
    }

    planner {
      type = append
    }

    output {
      type = postgresql-output
      append.impl = copy
      datasource = ${global.datasource.dwh}
      table = "dwd.dwd_his_ip_charges_p201808_cloned"
      batch-size = 100
    }
  }
}
